dist: bionic

language: ruby
cache:
  - bundler

rvm:
  - 2.6.3

services:
  - postgresql

env:
  global:
    - MOZ_HEADLESS=1
    - CC_TEST_REPORTER_ID=59c9ecfc93beafa930ea8169ace46ecb771db3d298e08602179b62c0fdb4f177

addons:
  firefox: latest

before_script:
  - wget https://github.com/mozilla/geckodriver/releases/download/v0.26.0/geckodriver-v0.26.0-linux64.tar.gz
  - tar -xzf geckodriver-v0.26.0-linux64.tar.gz
  - bundle exec rake db:create
  - bundle exec rake db:migrate
  - bundle exec rake assets:precompile
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build

deploy:
  provider: heroku
  api_key:
    secure: nFlYe3NTa0oKwcWFovUjKNMwB0m+4hOF3gAJlmVfjdlrWQSS4CJbZCrLgsKgAUNef6j0IZ3No/phv+35WTP1dtbvQpBRBdTCTzHSlPM+S9nZFMOS6iE2MXojSmIy3tyebNwDBV2QJZ
+/PZ1GHgfECVSZBgYKElcDsUOSRK0ab+5rLatughSDK3/xKW6H2Uewth6MbGMRZVAkCIQerqCw7MeK34HVuiP49LdluHQMC4bwPZOHt7vgGvrfe7+SE2tp7oYic9ohHJX/XDNYETyYSn8t85me994
eyJzt8EJlX2Y356azABH0gZoR7sCLwmx1JyPMRY6F5Ex6d6urDR9YOA0NaGSa19LF2Fj4ZX6WYtR5Ppo5KkUNGzrn1qEl0SONtqyHysIryFyQE1SRlslIkeZfpwYoxGlx+7vPH3PcMFY0h8pAMYP/
FVEbcxk5m4gic6A9h0yukUsa4KZTKsEWxVrBf5tLarUrMlwuCnA2GFqFelPRJKUXQoQ+5R4IYmQR4+Iq00hgroWiTxZzA1uuWs2XhT4zETfjC5QhBaW0sU6LYAsPeanXm0OuZv/sCaWcjT9sB+d9s
/nfMrrtYuodf784J3MBoKiRgoNQ5LhYVR4qESVMJis/U0SvUftZOLTnL+v7K/vv3+HkF4YUFYSYP0wKYe2e4tnY29hKEoqcPHo=
    app: warm-everglades-53164
    on:
      repo: denriquem/acebook--TeamFavouriteFreindLove-

script:
  - bundle exec rspec
  - bundle exec rubocop -c .rubocop.yml .

after_script:
- ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT
